import{d as e,r as l,v as a,q as t,m as o,O as s,o as u,c,w as i,a as r,u as d,x as n,z as m,b as v,t as p,n as f,J as h,H as V,i as y,g as _,y as k,h as w,j as x}from"./index-3f88d4b2.js";import{g,i as b,m as z,h as C,j as S,y as j,v as F,x as I,b as L,a as U}from"./page-wraper.84820f31.js";import{_ as M}from"./demo-block.5375f9a7.js";import{_ as P}from"./wd-button.18931a7d.js";const W=L(e({name:"wd-circle",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...g,modelValue:b(0),size:b(100),color:{type:[String,Object],default:"#4d80f0"},layerColor:z("#EBEEF5"),fill:String,speed:b(50),text:String,strokeWidth:b(10),strokeLinecap:z("round"),clockwise:C(!0)},setup(e){const w=e;const x=2*Math.PI,g=-Math.PI/2,b=1,z=l(""),C=l(1),L=l(0),U=l(null),M=l(S());let P=null;const W=a((()=>w.size*C.value)),O=a((()=>{const e={width:j(w.size),height:j(w.size)};return`${F(e)}; ${w.customStyle}`}));t((()=>w.modelValue),(()=>{!function(){if(w.speed<=0||w.speed>1e3)return void E(w.modelValue);G(),L.value=L.value||0;const e=()=>{U.value=setTimeout((()=>{L.value!==w.modelValue?(Math.abs(L.value-w.modelValue)<b?L.value=w.modelValue:L.value<w.modelValue?L.value+=b:L.value-=b,E(L.value),e()):G()}),1e3/w.speed)};e()}()}),{immediate:!0}),t((()=>w.size),(()=>{let e=setTimeout((()=>{E(L.value),clearTimeout(e)}),50)}),{immediate:!1}),t((()=>w.color),(()=>{E(L.value)}),{immediate:!1,deep:!0}),t((()=>w.layerColor),(()=>{E(L.value)}),{immediate:!1}),t((()=>w.strokeWidth),(()=>{E(L.value)}),{immediate:!1}),t((()=>w.clockwise),(()=>{E(L.value)}),{immediate:!1}),o((()=>{L.value=w.modelValue,E(L.value)})),s((()=>{G()}));const{proxy:T}=k();function $(e,l,a,t,o){const s=w.size*C.value;let u=w.strokeWidth*C.value;const c=s/2;o||(u/=2);const i=c-u/2;e.strokeStyle=l,e.setLineWidth(u),e.setLineCap(w.strokeLinecap),e.beginPath(),e.arc(c,c,i,a,t,!w.clockwise),e.stroke(),o&&(e.setLineWidth(u),e.setFillStyle(o),e.fill())}function E(e){const l=w.size*C.value;(P||(P=h(M.value,T)),Promise.resolve(P)).then((a=>{a.clearRect(0,0,l,l),function(e){$(e,w.layerColor,0,x,w.fill)}(a);const t=(o=e,Math.min(Math.max(o,0),100));var o;0!==t?function(e,l){const a=w.size*C.value,t=x*(l/100),o=w.clockwise?g+t:3*Math.PI-(g+t);if(I(w.color)){const l=e.createLinearGradient(a,0,0,0);Object.keys(w.color).sort(((e,l)=>parseFloat(e)-parseFloat(l))).map((e=>l.addColorStop(parseFloat(e)/100,w.color[e]))),z.value=l}else z.value=w.color;$(e,z.value,g,o)}(a,t):function(e){const l=w.size*C.value,a=w.strokeWidth*C.value,t=l/2;if(I(w.color)){const a=e.createLinearGradient(l,0,0,0);Object.keys(w.color).sort(((e,l)=>parseFloat(e)-parseFloat(l))).map((e=>a.addColorStop(parseFloat(e)/100,w.color[e]))),z.value=a}else z.value=w.color;e.beginPath(),e.arc(t,a/4,a/4,0,x),e.setFillStyle(z.value),e.fill()}(a),a.draw()}))}function G(){U.value&&clearTimeout(U.value)}return(e,l)=>{const a=V,t=y,o=_;return u(),c(t,{class:f(`wd-circle ${e.customClass}`),style:n(e.customStyle)},{default:i((()=>[r(a,{width:d(W),height:d(W),style:n(d(O)),id:M.value,"canvas-id":M.value},null,8,["width","height","style","id","canvas-id"]),e.text?(u(),c(o,{key:1,class:"wd-circle__text"},{default:i((()=>[v(p(e.text),1)])),_:1})):(u(),c(t,{key:0,class:"wd-circle__text"},{default:i((()=>[m(e.$slots,"default",{},void 0,!0)])),_:3}))])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-3bdf7e94"]]),O=L(e({__name:"Index",setup(e){const a=l(20),t={0:"red",100:"white"};function o(){a.value<100&&(a.value+=10)}function s(){a.value>0&&(a.value-=10)}return(e,l)=>{const d=w(x("wd-circle"),W),n=w(x("demo-block"),M),m=y,f=w(x("wd-button"),P),h=w(x("page-wraper"),U);return u(),c(m,{class:"circle"},{default:i((()=>[r(h,null,{default:i((()=>[r(n,{title:"基础用法"},{default:i((()=>[r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),text:a.value+"%"},null,8,["modelValue","text"])])),_:1}),r(n,{title:"样式定制"},{default:i((()=>[r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value=e),"stroke-width":6,text:"宽度定制"},null,8,["modelValue"]),r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value=e),"layer-color":"#eee",color:"#ee0a24",text:"颜色定制"},null,8,["modelValue"]),r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value=e),color:t,text:"渐变色"},null,8,["modelValue"]),r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value=e),color:"#07c160",clockwise:!1,text:"逆时针"},null,8,["modelValue"]),r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[5]||(l[5]=e=>a.value=e),size:120,text:"大小定制"},null,8,["modelValue"])])),_:1}),r(n,{title:"使用slot"},{default:i((()=>[r(d,{"custom-class":"custom-circle",modelValue:a.value,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value=e),"stroke-width":6},{default:i((()=>[r(m,{style:{color:"red"}},{default:i((()=>[v(p(a.value)+"%",1)])),_:1})])),_:1},8,["modelValue"])])),_:1}),r(n,null,{default:i((()=>[r(f,{"custom-style":"margin-right:24rpx",type:"primary",size:"small",onClick:o},{default:i((()=>[v("增加")])),_:1}),r(f,{type:"error",size:"small",onClick:s},{default:i((()=>[v("减少")])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-d552201c"]]);export{O as default};
